<div class="container">
  <h3 style="color: white;" class="mb-4">Manage Orders</h3>

  <div *ngIf="orders.length === 0" class="text-center mt-5">
    <p style="color: white;">No orders for your books yet.</p>
  </div>

  <div *ngFor="let order of orders" class="card mb-3 shadow-sm order-card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <div>
        <strong>Order #{{ order.id }}</strong> - 
        <span class="badge" [ngClass]="{
          'bg-warning': order.status === 'PENDING',
          'bg-success': order.status === 'COMPLETED'
        }">
          {{ order.status }}
        </span>
      </div>
      <div class="d-flex align-items-center gap-2">
        <select 
          [(ngModel)]="order.status" 
          (ngModelChange)="updateStatus(order, $event)"
          class="form-select form-select-sm status-select"
        >
          <option value="PENDING">PENDING</option>
          <option value="COMPLETED">COMPLETED</option>
        </select>

        <button 
          class="btn btn-link btn-sm toggle-btn" 
          (click)="toggleExpand(order.id)"
        >
          <i class="bi" [ngClass]="{
            'bi-chevron-up': expandedOrders[order.id],
            'bi-chevron-down': !expandedOrders[order.id]
          }"></i>
          {{ expandedOrders[order.id] ? 'Hide Items' : 'Show Items' }}
        </button>
      </div>
    </div>

    <div *ngIf="expandedOrders[order.id]" class="card-body">
      <table class="table table-bordered table-sm table-hover">
        <thead class="table-light">
          <tr>
            <th>Book ID</th>
            <th>Book Title</th>
            <th>Quantity</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of order.items">
            <td>{{ item?.book?.id }}</td>
            <td>{{ item?.book?.title }}</td>
            <td>{{ item?.quantity }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>